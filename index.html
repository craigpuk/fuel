<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Flue Gas Analysis</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 20px;
            background-color: #f5f5f5;
        }
        h1, h2, h3 {
            text-align: center;
            color: #333;
        }
        table {
            width: 100%;
            border-collapse: collapse;
            margin-bottom: 25px;
        }
        th, td {
            border: 1px solid #ccc;
            padding: 6px;
            text-align: right;
        }
        th {
            background-color: #eee;
        }
        .input-cell {
            background-color: #fff7e6;
        }
        .output-cell {
            background-color: #e6ffe6;
        }
        .note {
            font-size: 0.9em;
            color: #555;
            text-align: center;
        }
        .disclaimer {
            font-size: 0.85em;
            color: #888;
            text-align: center;
            margin-top: 30px;
        }
        .center {
            text-align: center;
        }
        input[type="number"] {
            width: 80px;
        }
    </style>
</head>
<body>
    <h1>Flue Gas Analysis</h1>
    <h2>Fuel Information</h2>
    <table>
        <tr>
            <th>Parameter</th>
            <th>Value</th>
        </tr>
        <tr>
            <td>Fuel Name / Reference</td>
            <td><input type="text" id="fuelName" value="Gas Oil"></td>
        </tr>
        <tr>
            <td>Date</td>
            <td><input type="date" id="date" value="2016-12-05"></td>
        </tr>
        <tr>
            <td>Issue</td>
            <td><input type="text" id="issue" value="ISSUE 1.1 [05-Dec-2016]"></td>
        </tr>
    </table>

    <h2>Fuel Properties</h2>
    <table>
        <tr>
            <th>Property</th>
            <th>Value</th>
            <th>Unit</th>
        </tr>
        <tr>
            <td>Fuel Flow Rate</td>
            <td><input type="number" id="fuelFlowRate" value="1.0" step="0.01"></td>
            <td>m³/h</td>
        </tr>
        <tr>
            <td>Fuel Density</td>
            <td><input type="number" id="fuelDensity" value="850" step="0.1"></td>
            <td>kg/m³</td>
        </tr>
    </table>

    <h2>Elemental Mass % Analysis</h2>
    <table>
        <tr>
            <th>Component</th>
            <th>Mass %</th>
        </tr>
        <tr>
            <td>Carbon</td>
            <td><input type="number" id="carbon" value="86.0" step="0.001"></td>
        </tr>
        <tr>
            <td>Hydrogen</td>
            <td><input type="number" id="hydrogen" value="14.0" step="0.001"></td>
        </tr>
        <tr>
            <td>Sulphur</td>
            <td><input type="number" id="sulphur" value="0.0" step="0.001"></td>
        </tr>
        <tr>
            <td>Nitrogen</td>
            <td><input type="number" id="nitrogen" value="0.0" step="0.001"></td>
        </tr>
        <tr>
            <td>Oxygen</td>
            <td><input type="number" id="oxygen" value="0.0" step="0.001"></td>
        </tr>
        <tr>
            <td>Water</td>
            <td><input type="number" id="water" value="0.0" step="0.001"></td>
        </tr>
        <tr>
            <td>Ash</td>
            <td><input type="number" id="ash" value="0.0" step="0.001"></td>
        </tr>
        <tr>
            <td>Total</td>
            <td id="elementTotal">100.000</td>
        </tr>
    </table>

    <h2>Calculated Calorific Values</h2>
    <table>
        <tr>
            <th>Method</th>
            <th>GCV (MJ/kg)</th>
            <th>GCV (Btu/lb)</th>
            <th>NCV (MJ/kg)</th>
            <th>NCV (Btu/lb)</th>
        </tr>
        <tr>
            <td>Dulong's Formula</td>
            <td id="dulongGCV"></td>
            <td id="dulongGCVBtu"></td>
            <td id="dulongNCV"></td>
            <td id="dulongNCVBtu"></td>
        </tr>
    </table>

    <h2>Combustion Calculations</h2>
    <table>
        <tr>
            <th>Parameter</th>
            <th>Value</th>
            <th>Unit</th>
        </tr>
        <tr>
            <td>Stoichiometric Oxygen</td>
            <td id="stoicO2"></td>
            <td>kg O₂/kg fuel</td>
        </tr>
        <tr>
            <td>Stoichiometric Air</td>
            <td id="stoicAir"></td>
            <td>kg air/kg fuel</td>
        </tr>
        <tr>
            <td>Total Air Required</td>
            <td id="totalAirRequired"></td>
            <td>Nm³/h</td>
        </tr>
    </table>

    <h2>Air Requirement at Different Excess Air Percentages</h2>
    <table>
        <tr>
            <th>% Excess Air</th>
            <th>Air Required (kg/h)</th>
            <th>Air Required (Nm³/h)</th>
        </tr>
        <!-- Rows will be inserted here by JavaScript -->
        <tbody id="airRequirementTable"></tbody>
    </table>

    <div class="center">
        <button onclick="calculate()">Calculate</button>
    </div>

    <p class="note">Note: Adjust the fuel properties and elemental composition, then click "Calculate" to update the results.</p>

    <p class="disclaimer">This document is confidential information of Hamworthy Combustion Engineering Ltd. and its affiliates, and must not be reproduced in whole or in part unless with written consent. ©</p>

    <script>
        function calculate() {
            // Get input values
            const carbon = parseFloat(document.getElementById('carbon').value) || 0;
            const hydrogen = parseFloat(document.getElementById('hydrogen').value) || 0;
            const sulphur = parseFloat(document.getElementById('sulphur').value) || 0;
            const nitrogen = parseFloat(document.getElementById('nitrogen').value) || 0;
            const oxygen = parseFloat(document.getElementById('oxygen').value) || 0;
            const water = parseFloat(document.getElementById('water').value) || 0;
            const ash = parseFloat(document.getElementById('ash').value) || 0;

            const fuelFlowRate = parseFloat(document.getElementById('fuelFlowRate').value) || 0; // m³/h
            const fuelDensity = parseFloat(document.getElementById('fuelDensity').value) || 0; // kg/m³

            // Total mass percentage
            const total = carbon + hydrogen + sulphur + nitrogen + oxygen + water + ash;
            document.getElementById('elementTotal').textContent = total.toFixed(3);

            // Convert fuel flow rate to kg/h
            const fuelMassFlowRate = fuelFlowRate * fuelDensity; // kg/h

            // Dulong's formula for GCV
            const GCV = (337 * carbon + 1442 * (hydrogen - oxygen / 8) + 22 * sulphur) / 1000; // MJ/kg
            const GCV_Btu = GCV * 429.923; // Btu/lb

            // NCV calculation
            const NCV = GCV - 24.43 * (hydrogen - oxygen / 8) / 1000; // MJ/kg
            const NCV_Btu = NCV * 429.923; // Btu/lb

            // Display Dulong's values
            document.getElementById('dulongGCV').textContent = GCV.toFixed(3);
            document.getElementById('dulongGCVBtu').textContent = GCV_Btu.toFixed(0);
            document.getElementById('dulongNCV').textContent = NCV.toFixed(3);
            document.getElementById('dulongNCVBtu').textContent = NCV_Btu.toFixed(0);

            // Stoichiometric oxygen calculation (kg O2 per kg fuel)
            const stoicO2 = (carbon / 100) * (32 / 12) + (hydrogen / 100) * (8 / 1) + (sulphur / 100) * (32 / 32) - (oxygen / 100) * (1);
            document.getElementById('stoicO2').textContent = stoicO2.toFixed(3);

            // Stoichiometric air (assuming air is 23.2% O2 by mass)
            const O2_in_air = 0.232;
            const stoicAir = stoicO2 / O2_in_air;
            document.getElementById('stoicAir').textContent = stoicAir.toFixed(3);

            // Total air required at stoichiometric conditions (kg/h)
            const totalAirRequiredStoic = fuelMassFlowRate * stoicAir; // kg/h

            // Convert air required to Nm³/h (assuming air density at NTP is 1.293 kg/Nm³)
            const airDensity = 1.293; // kg/Nm³
            const totalAirRequiredStoicNm3h = totalAirRequiredStoic / airDensity; // Nm³/h
            document.getElementById('totalAirRequired').textContent = totalAirRequiredStoicNm3h.toFixed(2);

            // Air Requirement for different excess air percentages
            const excessAirValues = [0, 5, 10, 15, 20, 25, 30, 35, 40, 45, 50, 55];
            const airRequirementTable = document.getElementById('airRequirementTable');
            airRequirementTable.innerHTML = ''; // Clear previous results

            excessAirValues.forEach(function (excessAir) {
                // Actual air supplied per kg fuel
                const actualAir = stoicAir * (1 + excessAir / 100); // kg air/kg fuel

                // Total air required (kg/h)
                const totalAirRequiredKgPerH = fuelMassFlowRate * actualAir; // kg/h

                // Total air required (Nm³/h)
                const totalAirRequiredNm3PerH = totalAirRequiredKgPerH / airDensity; // Nm³/h

                // Create table row
                const row = document.createElement('tr');

                const cellExcessAir = document.createElement('td');
                cellExcessAir.textContent = excessAir.toFixed(2);
                row.appendChild(cellExcessAir);

                const cellAirKgH = document.createElement('td');
                cellAirKgH.textContent = totalAirRequiredKgPerH.toFixed(2);
                row.appendChild(cellAirKgH);

                const cellAirNm3H = document.createElement('td');
                cellAirNm3H.textContent = totalAirRequiredNm3PerH.toFixed(2);
                row.appendChild(cellAirNm3H);

                airRequirementTable.appendChild(row);
            });
        }

        // Initial calculation on page load
        calculate();
    </script>
</body>
</html>
